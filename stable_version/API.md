# API Endpoints

## –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

–í—Å–µ API endpoints –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç JSON (–∫—Ä–æ–º–µ HTML –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞) –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ HTTP –º–µ—Ç–æ–¥—ã.

**–ë–∞–∑–æ–≤—ã–π URL**: `http://{IP_ESP32}`

**–ö–æ–¥–∏—Ä–æ–≤–∫–∞**: UTF-8

---

## üìÑ –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã

### `GET /`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

**–û—Ç–≤–µ—Ç**: HTML —Ñ–∞–π–ª –∏–∑ SPIFFS (`/index.html`)

**Content-Type**: `text/html; charset=utf-8`

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**: –ü–æ—Ç–æ–∫–æ–≤–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ —Ñ–∞–π–ª–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏.

---

## üìä API –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

### `GET /api/status`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ —Å–∏—Å—Ç–µ–º—ã

**–û—Ç–≤–µ—Ç**:
```json
{
  "supplyTemp": 65.5,
  "returnTemp": 55.0,
  "boilerTemp": 70.0,
  "outdoorTemp": -5.0,
  "setpoint": 60.0,
  "fan": true,
  "pump": false,
  "systemEnabled": true,
  "state": "HEATING",
  "wifiStatus": "–ü–æ–¥–∫–ª—é—á–µ–Ω",
  "wifiRSSI": -45,
  "coalFeeding": false,
  "coalFeedingRemaining": 0
}
```

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**: –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥.

---

### `GET /api/settings/auto`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–∂–∏–º–∞

**–û—Ç–≤–µ—Ç**:
```json
{
  "setpoint": 60.0,
  "minTemp": 45.0,
  "maxTemp": 75.0,
  "hysteresis": 2.0,
  "inertiaTemp": 55.0,
  "inertiaTime": 10,
  "overheatTemp": 77.0,
  "heatingTimeout": 30
}
```

---

### `GET /api/settings/mqtt`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ MQTT

**–û—Ç–≤–µ—Ç**:
```json
{
  "enabled": true,
  "server": "m5.wqtt.ru",
  "port": 5374,
  "useTLS": false,
  "user": "u_OLTTB0",
  "password": "XDzCIXr0",
  "prefix": "kotel/device1",
  "tempInterval": 10,
  "stateInterval": 30
}
```

---

### `GET /api/wifi/info`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ WiFi –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏

**–û—Ç–≤–µ—Ç**:
```json
{
  "ssid": "MyWiFi",
  "ip": "192.168.1.100",
  "rssi": -45,
  "mac": "E4:65:B8:13:83:94"
}
```

---

### `GET /api/wifi/scan/results`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è WiFi —Å–µ—Ç–µ–π

**–û—Ç–≤–µ—Ç (—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ)**:
```json
{
  "scanning": true,
  "message": "–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ..."
}
```

**–û—Ç–≤–µ—Ç (—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≥–æ—Ç–æ–≤—ã)**:
```json
{
  "scanning": false,
  "count": 5,
  "success": true,
  "networks": [
    {
      "ssid": "MyWiFi",
      "rssi": -45,
      "channel": 6,
      "encryption": "WPA2",
      "hidden": false
    },
    {
      "ssid": "NeighborWiFi",
      "rssi": -67,
      "channel": 11,
      "encryption": "WPA/WPA2",
      "hidden": false
    }
  ]
}
```

**–¢–∏–ø—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è**:
- "–û—Ç–∫—Ä—ã—Ç–∞—è" - WIFI_AUTH_OPEN
- "WEP" - WIFI_AUTH_WEP
- "WPA" - WIFI_AUTH_WPA_PSK
- "WPA2" - WIFI_AUTH_WPA2_PSK
- "WPA/WPA2" - WIFI_AUTH_WPA_WPA2_PSK
- "WPA2 Enterprise" - WIFI_AUTH_WPA2_ENTERPRISE
- "WPA3" - WIFI_AUTH_WPA3_PSK
- "WPA2/WPA3" - WIFI_AUTH_WPA2_WPA3_PSK

---

### `GET /api/sensors/mapping`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–∏–≤—è–∑–∫–∏ –¥–∞—Ç—á–∏–∫–æ–≤ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã

**–û—Ç–≤–µ—Ç**:
```json
{
  "supply": "28FF1234567890AB",
  "return": "28FF1234567890CD",
  "boiler": "28FF1234567890EF",
  "outside": "28FF123456789012"
}
```

**–§–æ—Ä–º–∞—Ç –∞–¥—Ä–µ—Å–æ–≤**: OneWire –∞–¥—Ä–µ—Å –≤ —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ (16 —Å–∏–º–≤–æ–ª–æ–≤).

---

### `GET /api/system/info`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

**–û—Ç–≤–µ—Ç**:
```json
{
  "version": "1.0.3",
  "ip": "192.168.1.100",
  "mac": "E4:65:B8:13:83:94",
  "uptime": "1—á 30–º 45—Å",
  "freeMem": "250 KB"
}
```

**–§–æ—Ä–º–∞—Ç uptime**: "X—á Y–º Z—Å"

---

### `GET /api/coalFeeding`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–±—Ä–æ—Å–∞ —É–≥–ª—è

**–û—Ç–≤–µ—Ç**:
```json
{
  "coalFeeding": true,
  "remaining": 450
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `coalFeeding`: boolean - –∞–∫—Ç–∏–≤–µ–Ω –ª–∏ —Ä–µ–∂–∏–º
- `remaining`: int - –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –≤ —Å–µ–∫—É–Ω–¥–∞—Ö (0 –µ—Å–ª–∏ –Ω–µ –∞–∫—Ç–∏–≤–µ–Ω)

---

## ‚úèÔ∏è API –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

### `POST /api/setpoint`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —É—Å—Ç–∞–≤–∫–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `value` (float): –∑–Ω–∞—á–µ–Ω–∏–µ —É—Å—Ç–∞–≤–∫–∏ (40-80¬∞C)

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞**:
```
POST /api/setpoint?value=65.5
```

**–û—Ç–≤–µ—Ç (—É—Å–ø–µ—Ö)**:
```json
{
  "success": true,
  "setpoint": 65.5
}
```

**–û—Ç–≤–µ—Ç (–æ—à–∏–±–∫–∞)**:
```json
{
  "error": "Invalid value"
}
```

**–ö–æ–¥ –æ—Ç–≤–µ—Ç–∞**: 200 (—É—Å–ø–µ—Ö), 400 (–æ—à–∏–±–∫–∞)

**–î–µ–π—Å—Ç–≤–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ**:
1. –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏—è (40-80¬∞C)
2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `setpoint` –∏ `autoSettings.setpoint`
3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–ª–∞–≥–∞ `autoSettingsDirty` –¥–ª—è –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
4. –ü—É–±–ª–∏–∫–∞—Ü–∏—è –≤ MQTT (–µ—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω)

---

### `POST /api/control`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ (–≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä, –Ω–∞—Å–æ—Å)

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `device` (string): "fan" –∏–ª–∏ "pump"
- `state` (int): 0 (–≤—ã–∫–ª—é—á–∏—Ç—å) –∏–ª–∏ 1 (–≤–∫–ª—é—á–∏—Ç—å)

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞**:
```
POST /api/control?device=fan&state=1
```

**–û—Ç–≤–µ—Ç**:
```json
{
  "success": true,
  "device": "fan",
  "state": 1
}
```

**–ö–æ–¥ –æ—Ç–≤–µ—Ç–∞**: 200 (—É—Å–ø–µ—Ö), 400 (–æ—à–∏–±–∫–∞)

---

### `POST /api/system/enable`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `enabled` (int): 0 (–≤—ã–∫–ª—é—á–∏—Ç—å) –∏–ª–∏ 1 (–≤–∫–ª—é—á–∏—Ç—å)

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞**:
```
POST /api/system/enable?enabled=1
```

**–û—Ç–≤–µ—Ç**:
```json
{
  "success": true,
  "systemEnabled": true
}
```

**–î–µ–π—Å—Ç–≤–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ**:
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ EEPROM
- –ü—Ä–∏ –≤—ã–∫–ª—é—á–µ–Ω–∏–∏ ‚Üí –≤—ã–∫–ª—é—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–µ–ª–µ

---

### `POST /api/settings/auto`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–∂–∏–º–∞

**Content-Type**: `application/json`

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞**:
```json
{
  "setpoint": 60.0,
  "minTemp": 45.0,
  "maxTemp": 75.0,
  "hysteresis": 2.0,
  "inertiaTemp": 55.0,
  "inertiaTime": 10,
  "overheatTemp": 77.0,
  "heatingTimeout": 30
}
```

**–û—Ç–≤–µ—Ç**:
```json
{
  "success": true
}
```

**–î–µ–π—Å—Ç–≤–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ**: –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ EEPROM.

---

### `POST /api/settings/mqtt`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ MQTT

**Content-Type**: `application/json`

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞**:
```json
{
  "enabled": true,
  "server": "m5.wqtt.ru",
  "port": 5374,
  "useTLS": false,
  "user": "u_OLTTB0",
  "password": "XDzCIXr0",
  "prefix": "kotel/device1",
  "tempInterval": 10,
  "stateInterval": 30
}
```

**–û—Ç–≤–µ—Ç**:
```json
{
  "success": true
}
```

**–î–µ–π—Å—Ç–≤–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ**:
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ EEPROM
- –ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MQTT –±—Ä–æ–∫–µ—Ä—É

---

### `POST /api/mqtt/test`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ MQTT –±—Ä–æ–∫–µ—Ä—É

**–û—Ç–≤–µ—Ç (—É—Å–ø–µ—Ö)**:
```json
{
  "success": true,
  "message": "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ"
}
```

**–û—Ç–≤–µ—Ç (–æ—à–∏–±–∫–∞)**:
```json
{
  "success": false,
  "message": "–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: -2"
}
```

**–î–µ–π—Å—Ç–≤–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ**: –í—ã–∑—ã–≤–∞–µ—Ç `mqttConnect()` –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

---

### `POST /api/wifi/scan`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ó–∞–ø—É—Å–∫ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è WiFi —Å–µ—Ç–µ–π

**–û—Ç–≤–µ—Ç**:
```json
{
  "scanning": true,
  "message": "–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ"
}
```

**–î–µ–π—Å—Ç–≤–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ**:
- –ó–∞–ø—É—Å–∫–∞–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ: `WiFi.scanNetworks(true, true)`
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ñ–ª–∞–≥ `wifiScanInProgress = true`

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–ª—É—á–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `/api/wifi/scan/results`.

---

### `POST /api/wifi/reset`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –°–±—Ä–æ—Å –Ω–∞—Å—Ç—Ä–æ–µ–∫ WiFi

**–û—Ç–≤–µ—Ç**:
```json
{
  "success": true
}
```

**–î–µ–π—Å—Ç–≤–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ**:
- –°–±—Ä–æ—Å –Ω–∞—Å—Ç—Ä–æ–µ–∫ —á–µ—Ä–µ–∑ `wifiManager.resetSettings()`
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ `pendingRebootTime` –¥–ª—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —á–µ—Ä–µ–∑ 500–º—Å

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–∞—è (–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ loop()).

---

### `POST /api/sensors/scan`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç—á–∏–∫–æ–≤ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã (–∑–∞–≥–ª—É—à–∫–∞)

**–û—Ç–≤–µ—Ç**:
```json
{
  "sensors": []
}
```

**TODO**: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ DS18B20.

---

### `POST /api/sensors/mapping`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏–≤—è–∑–∫–∏ –¥–∞—Ç—á–∏–∫–æ–≤

**Content-Type**: `application/json`

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞**:
```json
{
  "supply": "28FF1234567890AB",
  "return": "28FF1234567890CD",
  "boiler": "28FF1234567890EF",
  "outside": "28FF123456789012"
}
```

**–û—Ç–≤–µ—Ç**:
```json
{
  "success": true
}
```

---

### `POST /api/system/reboot`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

**–û—Ç–≤–µ—Ç**:
```json
{
  "success": true
}
```

**–î–µ–π—Å—Ç–≤–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ**:
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ `pendingRebootTime` –¥–ª—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —á–µ—Ä–µ–∑ 500–º—Å
- –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–∞—è

---

### `POST /api/coalFeeding`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ –ø–æ–¥–±—Ä–æ—Å–∞ —É–≥–ª—è

**–û—Ç–≤–µ—Ç**:
```json
{
  "success": true,
  "coalFeeding": true,
  "remaining": 450
}
```

**–î–µ–π—Å—Ç–≤–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ**:
- –ï—Å–ª–∏ –Ω–µ –∞–∫—Ç–∏–≤–µ–Ω ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç `startCoalFeeding()`
- –ï—Å–ª–∏ –∞–∫—Ç–∏–≤–µ–Ω ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç `stopCoalFeeding()`

---

## üîÑ OTA –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ

### `POST /update`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—à–∏–≤–∫–∏ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

**Content-Type**: `multipart/form-data`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `firmware` (file): —Ñ–∞–π–ª –ø—Ä–æ—à–∏–≤–∫–∏ (.bin)

**–ü—Ä–æ—Ü–µ—Å—Å**:
1. `UPLOAD_FILE_START`: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
2. `UPLOAD_FILE_WRITE`: –ó–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—à–∏–≤–∫–∏
3. `UPLOAD_FILE_END`: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞

**–û—Ç–≤–µ—Ç (—É—Å–ø–µ—Ö)**:
```
OK
```

**–û—Ç–≤–µ—Ç (–æ—à–∏–±–∫–∞)**:
```
FAIL
```

**–î–µ–π—Å—Ç–≤–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ**:
- –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞
- –ü—Ä–∏ –æ—à–∏–±–∫–µ ‚Üí –≤–æ–∑–≤—Ä–∞—Ç –æ—à–∏–±–∫–∏ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –±—É–¥–µ—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ –≤–æ –≤—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.

---

## ‚ùå –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### `404 Not Found`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ó–∞–ø—Ä–æ—Å –∫ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É endpoint

**–û—Ç–≤–µ—Ç**: `"Not Found"`

**Content-Type**: `text/plain`

---

### `400 Bad Request`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ù–µ–≤–µ—Ä–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞

**–û—Ç–≤–µ—Ç**:
```json
{
  "error": "Invalid value"
}
```
–∏–ª–∏
```json
{
  "error": "Missing parameters"
}
```

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **–ù–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**: –í—Å–µ endpoints –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –±—ã—Å—Ç—Ä–æ, –±–µ–∑ –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–¥–µ—Ä–∂–µ–∫.

2. **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**: –í—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å.

3. **JSON —Ñ–æ—Ä–º–∞—Ç**: –í—Å–µ –æ—Ç–≤–µ—Ç—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON (–∫—Ä–æ–º–µ HTML –∏ –æ—à–∏–±–æ–∫).

4. **–ö–æ–¥–∏—Ä–æ–≤–∫–∞**: UTF-8 –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∫–∏—Ä–∏–ª–ª–∏—Ü—ã.

5. **CORS**: –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è (–≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã —Å –æ–¥–Ω–æ–≥–æ –¥–æ–º–µ–Ω–∞).

6. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç (–ª–æ–∫–∞–ª—å–Ω–∞—è —Å–µ—Ç—å).

---

## üîó –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ (JavaScript)
```javascript
fetch('/api/status')
  .then(r => r.json())
  .then(data => {
    console.log('–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø–æ–¥–∞—á–∏:', data.supplyTemp);
  });
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —É—Å—Ç–∞–≤–∫–∏ (JavaScript)
```javascript
fetch('/api/setpoint?value=65', { method: 'POST' })
  .then(r => r.json())
  .then(data => {
    console.log('–£—Å—Ç–∞–≤–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞:', data.setpoint);
  });
```

### –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ WiFi (JavaScript)
```javascript
// –ó–∞–ø—É—Å–∫ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
fetch('/api/wifi/scan', { method: 'GET' })
  .then(r => r.json())
  .then(data => {
    console.log('–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ');
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
    const checkInterval = setInterval(() => {
      fetch('/api/wifi/scan/results')
        .then(r => r.json())
        .then(results => {
          if (!results.scanning) {
            clearInterval(checkInterval);
            console.log('–ù–∞–π–¥–µ–Ω–æ —Å–µ—Ç–µ–π:', results.count);
            console.log('–°–µ—Ç–∏:', results.networks);
          }
        });
    }, 1000);
  });
```

### –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—à–∏–≤–∫–∏ (JavaScript)
```javascript
const fileInput = document.getElementById('otaFile');
const file = fileInput.files[0];
const formData = new FormData();
formData.append('firmware', file);

fetch('/update', {
  method: 'POST',
  body: formData
})
.then(response => {
  if (response.ok) {
    console.log('–ü—Ä–æ—à–∏–≤–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!');
  }
});
```

